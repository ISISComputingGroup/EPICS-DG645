record(bo, "$(P)$(R)$(Q)DISABLE") 
{
    field(DESC, "Disable comms")
    field(PINI, "YES")
    field(VAL, "$(DISABLE=0)")
    field(OMSL, "supervisory")
    field(ZNAM, "COMMS ENABLED")
    field(ONAM, "COMMS DISABLED")
}

# Delay set

record(stringout,"$(P)$(R)$(Q)DELAY:SP")
{
    field(DESC, "Chan $(Q) setpoint")
    field(SCAN, "Passive")
}

record(mbbo,"$(P)$(R)$(Q)DELAYUNIT:SP")
{
    field(DESC, "Chan $(Q) unit setpoint")
    field(SCAN, "Passive")
    field(ZRST, "s")
    field(ONST, "ms")
    field(TWST, "us")
    field(THST, "ns")
    field(FRST, "ps")
    field(ZRVL, "0")
    field(ONVL, "3")
    field(TWVL, "6")
    field(THVL, "9")
    field(FRVL, "12")
    field(DTYP, "Soft Channel")
}

record(calcout,"$(P)$(R)$(Q)DELAYUNITOUT")
{
    field(DESC, "Chan $(Q) setpoint calc")
    field(SCAN, "Passive")
    field(INPA, "$(P)$(R)$(Q)DELAY:SP")
    field(INPB, "$(P)$(R)$(Q)DELAYUNIT:SP.RVAL")
    field(CALC, "A*(10^(-1*B))")
    field(OUT, "$(P)$(R)$(Q)DelayAO")
    field(FLNK, "$(P)$(R)$(Q)DelayAO.PROC")
	field(ASG, "READONLY")
}

record(fanout,"$(P)$(R)$(Q)DELAYBUTTON")
{
    field(DESC, "Set Chan $(Q) setting button")
    field(SCAN, "Passive")
    field(LNK1, "$(P)$(R)$(Q)DELAYUNITOUT")
    field(LNK2, "$(P)$(R)$(Q)REFERENCESEQUENCE")
}

record(stringout,"$(P)$(R)$(Q)REFERENCE:SP")
{
    field(DESC, "Chan $(Q) setpoint ref")
    field(SCAN, "Passive")
}

record(sseq,"$(P)$(R)$(Q)REFERENCESEQUENCE")
{
    field(DESC, "Chan $(Q) Reference set")
    field(SCAN, "Passive")
    field(DOL1, "$(P)$(R)$(Q)REFERENCE:SP")
    field(LNK1, "$(P)$(R)$(Q)ReferenceMO")
    field(FLNK, "$(P)$(R)$(Q)ReferenceMO.PROC")
}

# Delay actual

record(calc,"$(P)$(R)$(Q)DELAYCONVERT")
{
    field(PINI, "YES")
    field(DESC, "$(Q) value conversion")
    field(SCAN, "Passive")
    field(PREC, "12")
    field(INPA, "$(P)$(R)$(Q)DelayAI CP")
    field(CALC, "(A>1)?A:((A*1e3>1)?A*1e3:((A*1e6>1)?A*1e6:((A*1e9>1)?A*1e9:A*1e12)))")
	field(ASG, "READONLY")
}

record(ai,"$(P)$(R)$(Q)DELAY:RB")
{
    field(DESC, "$(Q) value input")
    field(SCAN, "Passive")
    field(PREC, "8")
    field(INP, "$(P)$(R)$(Q)DELAYCONVERT CP")
    field(ASG, "READONLY")
    info(INTEREST, "HIGH")
	field(EGU, "")
}

record(scalcout,"$(P)$(R)$(Q)DELAYUNIT:RB")
{
    field(PINI, "YES")
    field(DESC, "$(Q) unit conversion")
    field(SCAN, "Passive")
    field(INPA, "$(P)$(R)$(Q)DelayAI CP")
    field(CALC, "(A>1)?'s':((A*1e3>1)?'ms':((A*1e6>1)?'us':((A*1e9>1)?'ns':'ps')))")
    field(ASG, "READONLY")
    info(INTEREST, "HIGH")
}

# Delay width

record(calc,"$(P)$(R)$(Q)DELAYWIDTH")
{
    field(PINI, "YES")
    field(DESC, "$(Q) Delay width")
    field(SCAN, "Passive")
    field(PREC, "12")
    field(INPA, "$(P)$(R)T0DelayAI CP")
    field(INPB, "$(P)$(R)T1DelayAI CP")
    field(INPC, "$(P)$(R)ADELAYWIDTH CP")
    field(INPD, "$(P)$(R)BDELAYWIDTH CP")
    field(INPE, "$(P)$(R)CDELAYWIDTH CP")
    field(INPF, "$(P)$(R)DDELAYWIDTH CP")
    field(INPG, "$(P)$(R)EDELAYWIDTH CP")
    field(INPH, "$(P)$(R)FDELAYWIDTH CP")
    field(INPI, "$(P)$(R)GDELAYWIDTH CP")
    field(INPJ, "$(P)$(R)HDELAYWIDTH CP")
    field(INPK, "$(P)$(R)$(Q)ReferenceMI.RVAL CP")
    field(INPL, "$(P)$(R)$(Q)DelayAI CP")
    field(CALC, "L+(K=0?A:(K=1?B:(K=2?C:(K=3?D:(K=4?E:(K=5?F:(K=6?G:(K=7?H:(K=8?I:J)))))))))")
	field(ASG, "READONLY")
}

record(scalcout,"$(P)$(R)$(Q)DELAYWIDTHUNIT:RB")
{
    field(PINI, "YES")
    field(DESC, "$(Q) Width unit convert")
    field(SCAN, "Passive")
    field(INPA, "$(P)$(R)$(Q)DELAYWIDTH CP")
    field(CALC, "(A>1)?'s':((A*1e3>1)?'ms':((A*1e6>1)?'us':((A*1e9>1)?'ns':'ps')))")
    field(ASG, "READONLY")
    info(INTEREST, "HIGH")
}
